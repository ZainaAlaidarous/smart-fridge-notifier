# ๐ ุงุณู ุงููููุฉ ุงูุธุงูุฑ ูู GitHub Actions
name: Daily Notification Checker

# โฐ ุฌุฏูู ุชุดุบูู ุงููููุฉ:
on:
  schedule:
    - cron: '0 */1 * * *'  # โ ูุชู ุชุดุบูููุง ูู ุณุงุนุฉ (ูุฃุบุฑุงุถ ุงูุชุฌุฑุจุฉ). ูููู ุชุบููุฑู ูุงุญููุง ุฅูู ูู ููู
  workflow_dispatch:        # โ ูุชูุญ ูู ุชุดุบูููุง ูุฏูููุง ูู ูุงุฌูุฉ GitHub

jobs:
  run-script:
    runs-on: ubuntu-latest  # ๐ฅ๏ธ ูุธุงู ุงูุชุดุบูู ุงููุณุชุฎุฏู ูุชุดุบูู ุงูุณูุฑุจุช (Ubuntu ูู GitHub)

    steps:
      # โฌ๏ธ ุงูุฎุทูุฉ 1: ูุณุฎ ูููุงุช ุงููุดุฑูุน ูู GitHub
      - name: โฌ๏ธ Checkout repository
        uses: actions/checkout@v3

      # ๐ง ุงูุฎุทูุฉ 2: ุชููุฆุฉ Python ูุงุณุชุฎุฏุงูู
      - name: ๐ง Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'  # ๐ข ุงูุฅุตุฏุงุฑ ุงููุทููุจ ูู Python

      # ๐ฆ ุงูุฎุทูุฉ 3: ุชุซุจูุช ุงูููุชุจุงุช ุงููุทููุจุฉ ูู requirements.txt
      - name: ๐ฆ Install dependencies
        run: |
          pip install -r requirements.txt

      # โ ุงูุฎุทูุฉ 4: ุชุดุบูู check_expired_products.py ููุญุต ุงูููุชุฌุงุช ูุฅูุดุงุก ุฅุดุนุงุฑุงุช ูู Firestore
      - name: โ Run check_expired_products.py (check expired products)
        env:
          SERVICE_ACCOUNT_KEY: ${{ secrets.SERVICE_ACCOUNT_KEY }}  # ๐ ููุชุงุญ Firebase ูุชู ุชุญูููู ูู GitHub Secrets
        run: python check_expired_products.py

      # ๐ค ุงูุฎุทูุฉ 5: ุชุดุบูู send_unread_notifications.py ูุฅุฑุณุงู ุฅุดุนุงุฑุงุช FCM ูููุณุชุฎุฏููู (ุบูุฑ ุงูููุฑูุกุฉ ููุท)
      - name: ๐ค Run send_unread_notifications.py (send FCM push)
        env:
          SERVICE_ACCOUNT_KEY: ${{ secrets.SERVICE_ACCOUNT_KEY }}  # ๐ ููุณ ุงูููุชุงุญ ูุณุชุฎุฏู ููุง
        run: python send_unread_notifications.py
