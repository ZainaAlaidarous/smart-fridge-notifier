# ๐ ุงุณู ุงููููุฉ ุงูุธุงูุฑ ูู GitHub Actions
name: Daily Notification Checker

# โฐ ุฌุฏูู ุชุดุบูู ุงููููุฉ:
on:
  schedule:
    - cron: '0 */1 * * *'  # โ ูุชู ุชุดุบูููุง ูู ุณุงุนุฉ (ูุฃุบุฑุงุถ ุงูุชุฌุฑุจุฉ)
  workflow_dispatch:        # โ ุชุดุบูู ูุฏูู ูู ูุงุฌูุฉ GitHub

jobs:
  run-script:
    runs-on: ubuntu-latest

    steps:
      # โฌ๏ธ ุงูุฎุทูุฉ 1: ูุณุฎ ูููุงุช ุงููุดุฑูุน ูู GitHub
      - name: โฌ๏ธ Checkout repository
        uses: actions/checkout@v3

      # ๐ง ุงูุฎุทูุฉ 2: ุชููุฆุฉ Python
      - name: ๐ง Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      # ๐ฆ ุงูุฎุทูุฉ 3: ุชุซุจูุช ุงูููุชุจุงุช ุงููุทููุจุฉ
      - name: ๐ฆ Install dependencies
        run: |
          pip install -r requirements.txt

      # โ ุงูุฎุทูุฉ 4: ุชุดุบูู main.py (ูุญุต ุงูููุชุฌุงุช ูุฅูุดุงุก ุงูุฅุดุนุงุฑุงุช)
      - name: โ Run main.py (check expired products)
        env:
          SERVICE_ACCOUNT_KEY: ${{ secrets.SERVICE_ACCOUNT_KEY }}
        run: python main.py

      # ๐ค ุงูุฎุทูุฉ 5: ุชุดุบูู send_unread_notifications.py ูุฅุฑุณุงู ุงูุฅุดุนุงุฑุงุช
      - name: ๐ค Run send_unread_notifications.py (send FCM push)
        env:
          SERVICE_ACCOUNT_KEY: ${{ secrets.SERVICE_ACCOUNT_KEY }}
        run: python send_unread_notifications.py
